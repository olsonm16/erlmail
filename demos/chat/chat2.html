<script type="text/javascript" src="/common/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="/ezwebframe/websock.js"></script>
<script src="//cdn.jsdelivr.net/emojione/1.3.0/lib/js/emojione.min.js"></script>
<link rel="stylesheet" href="./chat2.css" type="text/css">
<body>
  <h2>Chat</h2>
  <div id="idle">
    <input id="nick_input"/>
    <button id="join">Join</button>
    <br/>
  </div>
  <div id="running">
    <table>
      <tr>
	<td><div id="scroll"></div></td>
	<td><div id="users"></div></td>
      </tr>
      <tr>
	<td colspan="2">
	  <input id="tell" class="live_input"/><br/>
    <input type="file" id="filePicker"/>
    
	  <button class="live_button" id="leave">Leave</button>
	</td>
      </tr>
    </table>
  </div>
</body>

<style>
  .thumb {
    height: 75px;
    border: 1px solid #000;
    margin: 10px 5px 0 0;
  }
</style>

<script>
$(document).ready(run);

function run(){
  //$("#running").hide();
  var r = new FileReader();
  r.onload = function(){ alert(r.result); };
  $("#join").click(function(){
      var val = $("#nick_input").val();
      $("#nick_input").val("");
      send_json({'join':val});
      })
}

var handleFileSelect = function(evt) {
    var files = evt.target.files;
    var file = files[0];

    if (files && file) {
        var reader = new FileReader();

        reader.onload = function(readerEvt) {
            var binaryString = readerEvt.target.result;
            send_json({'photoBinary':btoa(binaryString)});
        };

        reader.readAsBinaryString(file);
    }
};

document.getElementById('filePicker').addEventListener('change', handleFileSelect, false);

function hide_div(o){
    $("#" + o.id).hide();
}
  
function show_div(o){
    $("#" + o.id).show();
}

connect_to_erlang("localhost", 1456, "chat2");

</script>
